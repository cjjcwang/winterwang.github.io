---
layout: post
title: "rMaps: 超酷的互动地图生成包"
mathjax: true
comments: true
category: R
tags: [R, rMaps, interactive]
---

今日仰视[slidify](https://github.com/ramnathv/slidify)制作者[Ramnath Vaidyanathan](https://github.com/ramnathv)的github页面发现超酷的[rMaps](https://github.com/ramnathv/rMaps)包，抄过来在自己电脑上实验一下。


### 下载

{% highlight r %}
require(devtools)
install_github('ramnathv/rCharts@dev')
install_github('ramnathv/rMaps')
{% endhighlight %}


### 在美国地图上绘制2010年的犯罪率 Crime Rates (per 100, 000) by State at 2010

截图:(原图上鼠标所在的州会自动显示英语的州名称)
![crime0](/image/crime0.png)

原图链接[点这里](http://rcharts.github.io/viewer/?25bf56df8416fe8bc22de5d725cde8ca)

可以利用以下R代码在Rstudio里面实现原图链接中的效果
{% highlight r %}
library(rMaps)
map <- ichoropleth(Crime ~ State, data = subset(violent_crime, Year == 2010))
map$publish("Crime Rates (per 100, 000) by State across Years") # <- 引号中的将会是生成的动态地图的网页名称
## Loading required package: httr
## Please enter your github username: ***** # <- 请输入你自己的用户名
## Please enter your github password: ***** # <- 请输入你自己的密码
## Your gist has been published
## View chart at http://rcharts.github.io/viewer/***** # <- 会出现你的网页版可互动地图链接用于分享
{% endhighlight %}

你也可以用下面的代码保存本地的单独网页(html)文件(可惜目前开发阶段，无网络连接时无法显示)。
{% highlight r %}
map$save("mymap.html", cdn = TRUE) # <- 引号中为保存的目标文件名
{% endhighlight %}


### 在美国地图上绘制1960-2010年的动态犯罪率 Crime Rates (per 100, 000) by State from 1960-2010

#### 动态阶级区分图/Animated Choropleth(鼠标控制)
代码:
{% highlight r %}
ichoropleth(Crime ~ State, data = violent_crime, animate = "Year")
{% endhighlight %}

截图(1960年):
![crime1](/image/crime1.png)
截图(2010年): 
![crime2](/image/crime2.png)
**注意左上角有可移动的滑动条**，原图链接[点这里](http://rcharts.github.io/viewer/?3aa0696e473b5bd16fc6bd2979758183)

#### 动态阶级区分图/Animated Choropleth(自动播放)
{% highlight r %}
ichoropleth(Crime ~ State, data = violent_crime, animate = "Year", play = TRUE)
{% endhighlight %}

截图: 
![crime3](/image/crime3.png)
**注意左上角滑动条变成了播放的按钮**，动画播放[点这里](http://rcharts.github.io/viewer/?d32e78d2795db1850b86827627e33c53)